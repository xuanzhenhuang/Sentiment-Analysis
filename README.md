# 🔥 ***Sentiment-Analysis***
用 Python 编写的微调 BERT 模型做情感极性分类项目，对 IMDB 影评数据进行数据分析，最终你可以收获一个准确率高于 **90%** 的分类模型！

<img src="https://github.com/xuanzhenhuang/Sentiment-Analysis/blob/main/image/Predict.png?raw=true" width="1000px">


## 💡 项目介绍
### 🌱 项目背景

随着互联网和社交媒体的快速发展，用户生成内容（UGC）的数量呈爆炸式增长，尤其是在影评、商品评论等领域。这些文本数据中蕴含着丰富的情感信息，能够为企业、研究机构和个人提供有价值的洞察。例如，电影制片方可以通过分析观众对电影的评论来了解观众的情感倾向，从而优化未来的电影制作和营销策略。然而，手动分析海量文本数据不仅耗时耗力，还容易受到主观因素的影响。因此，自动化情感分析技术应运而生，成为自然语言处理（NLP）领域的重要研究方向之一。

情感极性分类是情感分析的一个核心任务，旨在将文本划分为正面或负面等情感类别。传统的机器学习方法在处理复杂语义和上下文依赖时表现有限近年来，预训练语言模型（如BERT）的出现极大地提升了情感分类任务的性能。BERT（Bidirectional Encoder Representations from Transformers）通过双向Transformer架构捕捉文本的上下文信息，能够更好地理解文本的语义和情感倾向。

本项目旨在利用BERT模型对IMDB影评数据集进行情感极性分类。IMDB数据集是情感分析领域的经典数据集，包含50,000条电影评论，每条评论被标记为正面或负面。通过对这些评论进行数据分析，我们可以深入了解用户对电影的情感倾向，并进一步微调BERT模型以实现高精度的情感分类。此外，为了验证模型的泛化能力，我们还从互联网上抓取了2021年至2025年的10部电影累计921条最新影评数据，用于模型的二次验证。

---

### 🍔 项目流程

1. **数据预处理**  
   对IMDB影评数据进行清洗和格式化处理，以适应 BERT 模型的输入要求。通过各种数据处理库（如 Pandas、Re、Nltk）将所有的txt影评文件处理在一个excel表内、去除HTML标签、特殊字符、停用词等，并将数据顺序打乱。

2. **数据预览**  
   对IMDB数据集进行初步探索性分析（EDA），包括词频统计、评论长度统计、情感标签分布等。通过可视化工具（如Matplotlib、Seaborn）展示数据的基本特征。

3. **模型微调**  
   基于预训练的BERT模型，使用 IMDB 数据集进行微调，以适应情感分类任务。具体步骤包括：
   - 加载预训练的BERT模型（`bert-base-uncased`），初始化分类模型（`BertForSequenceClassification`），适用于二分类任务。
   - 使用 `AdamW` 优化器，适用于 BERT 模型的微调。
   - 调用GPU加速模型的训练和验证，对模型性能进行评估并计算准确率。

4. **数据抓取**  
   从IMDB官网上抓取2021年至2025年的921条最新影评数据，用于验证模型的泛化能力。抓取的数据包括电影编号、评论内容、评分、评论人数、发布时间等信息。

5. **数据处理**  
   对抓取的最新影评数据进行清洗和格式化处理。包括去除噪声数据、统一文本格式、进行情感标签标注。

6. **数据分析**  
   对抓取的最新影评数据进行探索性分析，比较其与IMDB数据集的差异。分析内容包括评分分布情况、点赞数和差评数的相关性、不同时间段的评价数量变化趋势、词频统计以及词云图可视化分析等。

7. **模型预测**  
   使用微调后的BERT模型对抓取的最新影评数据进行情感分类预测，并评估模型在新数据上的性能。

8. **总结**  
   总结项目的整体流程和结果，分析模型在IMDB数据集和最新影评数据上的表现差异。讨论模型的优缺点，并提出未来改进方向（如引入更多数据增强技术、尝试其他预训练模型等）。

---

### 🔎 项目亮点

1. **经典与最新数据的结合**  
   不仅使用了经典的IMDB数据集，还引入了最新的影评数据，验证模型在真实场景中的泛化能力。

2. **完整的NLP流程**  
   从数据预处理、模型微调、数据抓取到模型预测，涵盖了自然语言处理项目的全流程。

3. **技术深度**  
   使用BERT模型进行微调，展示了深度学习在情感分析任务中的强大能力。

4. **实际应用价值**  
   通过情感分析，为电影制片方、营销团队等提供了有价值的用户洞察。

## 🎬 快速开始

### 📝 前提条件

- 如果需要完整的50000条数据可以在[镜像站](https://ai.stanford.edu/~amaas/data/sentiment/)自行下载，为了上传方便，本文提供了数据量为5000条的minidatasets（已经预处理过可直接取用）
- PyTorch（可以根据自己电脑的配置情况在[PyTorch官网](https://pytorch.org/)安装）
- CUDA（如果有GPU并且想要用于加速模型训练的话需要自行安装一下CUDA）
- bert-base-uncased(可以在[huggingface官网](https://huggingface.co/google-bert/bert-base-uncased)将模型下载到本地)
  > 如果没有办法访问到huggingface官网的话也可以在 [镜像站](https://hf-mirror.com/) 自行安装。

### 🚀 执行顺序

1. **IMDbDataProcessing.py**  
   如果下载了IMDB源数据的话可以调用该程序将所有txt处理到一张excel表内，如果选择直接用minidatasets的话可以略过

2. **dataAnalysis.ipynb**  
   对数据进行初步探索性分析（EDA）和可视化分析

3. **SentimentAnalysis.ipynb**  
   创建模型并对模型进行微调训练以及验证，并进行实际的应用查看模型的预测效果。

4. **IMDbDataCrawler.ipynb**  
   在IMDB官网上抓取2021-2025年的十部电影的累计921条数据

5. **SaveBestModel.py**  
   可以试验多个模型并最终保存效果最优的模型到本地，便于后续调用

6. **dataAnalysis.ipynb**  
   同样对抓取到的数据进行初步探索性分析（EDA）和可视化分析

7. **Model_Prediction.ipynb**  
   调用第五步得到的最优模型进行预测，查看模型的预测效果。





